# =====================================================
# PRODUCTION ENVIRONMENT - AWS/VERCEL DEPLOYMENT
# =====================================================
# Complete .env file for backend deployment
# Last updated: February 2026

# =====================================================
# DATABASE (REQUIRED)
# =====================================================
# MongoDB Atlas connection
# Get from: https://cloud.mongodb.com/ → Database → Connect
DATABASE_URL=mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/mutual-funds?retryWrites=true&w=majority

# =====================================================
# JWT SECRETS (REQUIRED - CRITICAL FOR SECURITY)
# =====================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# NEVER reuse development secrets in production
JWT_SECRET=your_64_char_hex_string_here_generate_with_above_command_1234567890abcdef
JWT_REFRESH_SECRET=different_64_char_hex_string_here_never_same_as_jwt_secret_abcd

# =====================================================
# SERVER CONFIGURATION (REQUIRED)
# =====================================================
PORT=3002
NODE_ENV=production

# Frontend URL - Your Vercel/deployed frontend
FRONTEND_URL=https://your-app.vercel.app

# Allowed CORS origins (comma-separated, no spaces)
ALLOWED_ORIGINS=https://your-app.vercel.app,https://www.your-domain.com

# =====================================================
# REDIS (REQUIRED FOR CACHING & BACKGROUND JOBS)
# =====================================================
# Option 1: Upstash Redis (Recommended for Serverless)
# Free tier: 10,000 commands/day
# Get from: https://console.upstash.com/redis
REDIS_URL=rediss://default:password@endpoint.upstash.io:6379

# Option 2: Redis Labs
# REDIS_URL=rediss://default:password@redis-12345.cloud.redislabs.com:12345

# Or use separate parameters
REDIS_HOST=endpoint.upstash.io
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# =====================================================
# GOOGLE OAUTH (REQUIRED FOR LOGIN)
# =====================================================
# Get from: https://console.cloud.google.com/apis/credentials
# 1. Create OAuth 2.0 Client ID
# 2. Add authorized origins: https://your-backend.com
# 3. Add redirect URIs: https://your-backend.com/api/auth/google/callback
GOOGLE_CLIENT_ID=123456789-abcdefghijklmnop.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your_google_client_secret_here

# =====================================================
# RAPIDAPI - YAHOO FINANCE (REQUIRED)
# =====================================================
# Get from: https://rapidapi.com/apidojo/api/yahoo-finance1
# Free tier: 500 requests/month
# Basic: $9.99/month for 10,000 requests
RAPIDAPI_KEY=your_rapidapi_key_1234567890abcdef
RAPIDAPI_HOST=apidojo-yahoo-finance-v1.p.rapidapi.com

# =====================================================
# EMAIL SERVICE (REQUIRED FOR KYC & NOTIFICATIONS)
# =====================================================
# Option 1: Resend (Recommended)
# Free: 3,000 emails/month, 100 emails/day
# Get from: https://resend.com/api-keys
RESEND_API_KEY=re_123456789_abcdefghijklmnop

FROM_EMAIL=noreply@yourdomain.com
ADMIN_EMAIL=admin@yourdomain.com

# Option 2: Gmail SMTP (Alternative)
# EMAIL_SERVICE=gmail
# EMAIL_USER=your-email@gmail.com
# EMAIL_PASSWORD=your-16-char-app-password

# =====================================================
# NEWS APIS (REQUIRED FOR NEWS FEED)
# =====================================================
# NewsData.io
# Free tier: 200 requests/day
# Get from: https://newsdata.io/api-key
NEWSDATA_API_KEY=pub_1234567890abcdefghijklmnop

# News API (Backup)
# Free tier: 100 requests/day
# Get from: https://newsapi.org/register
NEWS_API_KEY=your_news_api_key_32_chars_here

# =====================================================
# GOOGLE GEMINI AI (REQUIRED FOR CHATBOT)
# =====================================================
# Free tier: 60 requests/minute, 1500 requests/day
# Get from: https://makersuite.google.com/app/apikey
GEMINI_API_KEY=AIzaSy_your_39_char_gemini_api_key_here

# =====================================================
# DATA SOURCES (REQUIRED)
# =====================================================
# AMFI NAV data (Indian mutual funds)
AMFI_NAV_URL=https://www.amfiindia.com/spages/NAVAll.txt

# =====================================================
# OPTIONAL SERVICES
# =====================================================
# Oracle VM Fallback (if you have separate Oracle instance)
# ORACLE_VM_URL=https://oracle-vm-ip:port/api
# ORACLE_API_KEY=your_bearer_token

# =====================================================
# SECURITY & PERFORMANCE
# =====================================================
# Session secret for session-based features
SESSION_SECRET=another_64_char_random_secret_for_sessions_here

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Timezone (for cron jobs)
TZ=Asia/Kolkata

# =====================================================
# DEPLOYMENT CHECKLIST
# =====================================================
# 
# ✅ 1. Replace ALL placeholder values above
# ✅ 2. Generate new JWT secrets (never reuse dev secrets)
# ✅ 3. Set up MongoDB Atlas with IP whitelist
# ✅ 4. Configure Redis (Upstash recommended for AWS/Vercel)
# ✅ 5. Get Google OAuth credentials
# ✅ 6. Get RapidAPI key for market data
# ✅ 7. Get Resend API key for emails
# ✅ 8. Get NewsData API key for news
# ✅ 9. Get Gemini API key for AI chatbot
# ✅ 10. Update FRONTEND_URL with actual domain
# ✅ 11. Test with: curl http://localhost:3002/api/health
# ✅ 12. Monitor with: pm2 logs backend
#
# =====================================================
# QUICK SETUP COMMANDS
# =====================================================
#
# 1. Copy this file to server:
#    scp .env user@server:/home/ubuntu/mutual-funds-backend/
#
# 2. Generate JWT secrets on server:
#    node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# 3. Test backend:
#    npm run build
#    npm start
#
# 4. Check health:
#    curl http://localhost:3002/api/health
#
# 5. Test optimized loading:
#    node test-optimized-loading.js
#
# =====================================================
